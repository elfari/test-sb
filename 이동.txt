<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>ExtJS 4.2 TreeGrid Example</title>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/extjs/4.2.1/resources/css/ext-all.css" rel="stylesheet" />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/extjs/4.2.1/ext-all.js"></script>

    <script type="text/javascript">
        Ext.onReady(function() {
            
            // 1. 데이터 모델 정의 (Model)
            Ext.define('TaskModel', {
                extend: 'Ext.data.Model',
                fields: [
                    {name: 'task',     type: 'string'},
                    {name: 'user',     type: 'string'},
                    {name: 'duration', type: 'string'}
                ]
            });

            // 2. 트리 스토어 생성 (TreeStore)
            // 실제 구현 시에는 proxy를 사용하여 서버(Oracle DB 등)에서 JSON을 받아옵니다.
            var store = Ext.create('Ext.data.TreeStore', {
                model: 'TaskModel',
                root: {
                    expanded: true,
                    children: [
                        { 
                            task: "프로젝트 설계", 
                            user: "홍길동", 
                            duration: "10일", 
                            expanded: true,
                            children: [
                                { task: "DB 스키마 설계", user: "김철수", duration: "3일", leaf: true },
                                { task: "UI 프로토타입", user: "이영희", duration: "5일", leaf: true },
                                { task: "요구사항 분석", user: "홍길동", duration: "2일", leaf: true }
                            ]
                        },
                        { 
                            task: "프로젝트 개발", 
                            user: "박민수", 
                            duration: "30일", 
                            expanded: true, // 초기 로딩 시 펼쳐짐 설정
                            children: [
                                { task: "공통 모듈 개발", user: "최지훈", duration: "10일", leaf: true },
                                { task: "비즈니스 로직 구현", user: "박민수", duration: "20일", leaf: true }
                            ]
                        },
                        { task: "테스트 및 배포", user: "운영팀", duration: "5일", leaf: true }
                    ]
                }
            });

            // 3. 트리 패널 생성 (TreePanel) -> 이것이 TreeGrid 역할
            Ext.create('Ext.tree.Panel', {
                title: '개발 일정 관리 (TreeGrid Sample)',
                width: 600,
                height: 400,
                renderTo: Ext.getBody(),
                collapsible: true,
                useArrows: true,      // 화살표 아이콘 사용
                rootVisible: false,   // 최상위 루트 노드 숨김
                store: store,
                multiSelect: true,
                
                // 그리드 컬럼 설정
                columns: [{
                    xtype: 'treecolumn', // 핵심: 계층 구조가 나타날 컬럼
                    text: '작업명 (Task)',
                    flex: 2,             // 너비 비율
                    sortable: true,
                    dataIndex: 'task'
                },{
                    text: '담당자',
                    flex: 1,
                    dataIndex: 'user',
                    sortable: true
                },{
                    text: '소요 기간',
                    width: 100,
                    dataIndex: 'duration',
                    align: 'center'      // 텍스트 정렬
                }]
            });
        });
    </script>
</head>
<body>
</body>
</html>
