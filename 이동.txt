SELECT
    A.PROCDEFID,
    -- LISTAGG 함수로 연속된 FLOWSEQ 값들을 콤마(,)로 연결하여 보여줍니다.
    LISTAGG(A.FLOWSEQ, ',') WITHIN GROUP (ORDER BY A.FLOWSEQ) AS CONSECUTIVE_FLOWSEQS,
    COUNT(*) AS CONSECUTIVE_COUNT
FROM
    (
        SELECT
            PROCDEFID,
            FLOWSEQ,
            DECISIONID,
            -- 연속되는 '19' 그룹을 식별하는 Group ID 생성
            (
                ROW_NUMBER() OVER (PARTITION BY PROCDEFID ORDER BY FLOWSEQ)
                -
                ROW_NUMBER() OVER (PARTITION BY PROCDEFID, DECISIONID ORDER BY FLOWSEQ)
            ) AS GRP
        FROM
            YourTableName  -- 실제 테이블 이름으로 변경하세요
        WHERE
            DECISIONID = 19 -- 찾고자 하는 숫자 값으로 필터링
    ) A
GROUP BY
    A.PROCDEFID,
    A.GRP
HAVING
    COUNT(*) >= 2 -- 연속되는 횟수가 2 이상인 그룹만 선택 (3개 이상을 원하시면 3으로 변경)
ORDER BY
    A.PROCDEFID,
    MIN(A.FLOWSEQ);
