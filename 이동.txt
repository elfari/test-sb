WITH RAW_DATA AS (
    -- 0. 입력 데이터 정의 (여기서만 수정)
    SELECT '갤럭시 갤럭시 S25!@#' AS target_str FROM DUAL
),
STEP_1 AS (
    -- 1. 영문, 숫자, 한글, 중문(一-龥) 제외 모든 문자를 공백으로 치환
    -- [^...] 내부에 허용할 문자 범위를 지정합니다.
    SELECT REGEXP_REPLACE(target_str, '[^a-zA-Z0-9가-힣一-龥]', ' ') AS clean_str
    FROM RAW_DATA
),
STEP_2 AS (
    -- 2. 공백 기준 파싱 후 중복 제거 및 순서 유지
    SELECT DISTINCT 
           REGEXP_SUBSTR(clean_str, '[^ ]+', 1, LEVEL) AS word,
           MIN(LEVEL) AS pos
    FROM STEP_1
    CONNECT BY REGEXP_SUBSTR(clean_str, '[^ ]+', 1, LEVEL) IS NOT NULL
    GROUP BY REGEXP_SUBSTR(clean_str, '[^ ]+', 1, LEVEL)
)
-- 최종 결과 출력 (원하는 단계의 SELECT문을 활성화해서 확인하세요)
SELECT LISTAGG(word, ' ') WITHIN GROUP (ORDER BY pos) AS final_result
FROM STEP_2;
